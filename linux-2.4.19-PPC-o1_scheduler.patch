diff -Nur linux-2.4.19.org/arch/ppc/kernel/idle.c linux-2.4.19/arch/ppc/kernel/idle.c
--- linux-2.4.19.org/arch/ppc/kernel/idle.c	Fri Sep  6 11:26:48 2002
+++ linux-2.4.19/arch/ppc/kernel/idle.c	Fri Sep  6 11:17:56 2002
@@ -55,7 +55,7 @@
 		do_power_save = 1;
 
 	/* endless loop with no priority at all */
-	init_idle();
+//	init_idle();
 
 	for (;;) {
 #ifdef CONFIG_SMP
diff -Nur linux-2.4.19.org/arch/ppc/kernel/mk_defs.c linux-2.4.19/arch/ppc/kernel/mk_defs.c
--- linux-2.4.19.org/arch/ppc/kernel/mk_defs.c	Tue Aug 28 15:58:33 2001
+++ linux-2.4.19/arch/ppc/kernel/mk_defs.c	Fri Sep  6 11:16:47 2002
@@ -37,8 +37,8 @@
 	/*DEFINE(KERNELBASE, KERNELBASE);*/
 	DEFINE(STATE, offsetof(struct task_struct, state));
 	DEFINE(NEXT_TASK, offsetof(struct task_struct, next_task));
-	DEFINE(COUNTER, offsetof(struct task_struct, counter));
-	DEFINE(PROCESSOR, offsetof(struct task_struct, processor));
+	DEFINE(COUNTER, offsetof(struct task_struct, time_slice));
+	DEFINE(PROCESSOR, offsetof(struct task_struct, cpu));
 	DEFINE(SIGPENDING, offsetof(struct task_struct, sigpending));
 	DEFINE(THREAD, offsetof(struct task_struct, thread));
 	DEFINE(MM, offsetof(struct task_struct, mm));
diff -Nur linux-2.4.19.org/include/asm-ppc/bitops.h linux-2.4.19/include/asm-ppc/bitops.h
--- linux-2.4.19.org/include/asm-ppc/bitops.h	Fri Sep  6 11:26:48 2002
+++ linux-2.4.19/include/asm-ppc/bitops.h	Thu Sep  5 10:36:32 2002
@@ -38,9 +38,9 @@
 	
 	__asm__ __volatile__("\n\
 1:	lwarx	%0,0,%3 \n\
-	or	%0,%0,%2 \n"
-	PPC405_ERR77(0,%3)
-"	stwcx.	%0,0,%3 \n\
+	or	%0,%0,%2 \n\
+	dcbt 	0,%3 \n\
+	stwcx.	%0,0,%3 \n\
 	bne-	1b"
 	: "=&r" (old), "=m" (*p)
 	: "r" (mask), "r" (p), "m" (*p)
@@ -72,9 +72,9 @@
 
 	__asm__ __volatile__("\n\
 1:	lwarx	%0,0,%3 \n\
-	andc	%0,%0,%2 \n"
-	PPC405_ERR77(0,%3)
-"	stwcx.	%0,0,%3 \n\
+	andc	%0,%0,%2 \n\
+	dcbt 	0,%3 \n\
+	stwcx.	%0,0,%3 \n\
 	bne-	1b"
 	: "=&r" (old), "=m" (*p)
 	: "r" (mask), "r" (p), "m" (*p)
@@ -100,9 +100,9 @@
 
 	__asm__ __volatile__("\n\
 1:	lwarx	%0,0,%3 \n\
-	xor	%0,%0,%2 \n"
-	PPC405_ERR77(0,%3)
-"	stwcx.	%0,0,%3 \n\
+	xor	%0,%0,%2 \n\
+	dcbt 	0,%3 \n\
+	stwcx.	%0,0,%3 \n\
 	bne-	1b"
 	: "=&r" (old), "=m" (*p)
 	: "r" (mask), "r" (p), "m" (*p)
@@ -131,9 +131,9 @@
 
 	__asm__ __volatile__(SMP_WMB "\n\
 1:	lwarx	%0,0,%4 \n\
-	or	%1,%0,%3 \n"
-	PPC405_ERR77(0,%4)
-"	stwcx.	%1,0,%4 \n\
+	or	%1,%0,%3 \n\
+	dcbt 	0,%4 \n\
+	stwcx.	%1,0,%4 \n\
 	bne	1b"
 	SMP_MB
 	: "=&r" (old), "=&r" (t), "=m" (*p)
@@ -164,9 +164,9 @@
 
 	__asm__ __volatile__(SMP_WMB "\n\
 1:	lwarx	%0,0,%4 \n\
-	andc	%1,%0,%3 \n"
-	PPC405_ERR77(0,%4)
-"	stwcx.	%1,0,%4 \n\
+	andc	%1,%0,%3 \n\
+	dcbt 	0,%4 \n\
+	stwcx.	%1,0,%4 \n\
 	bne	1b"
 	SMP_MB
 	: "=&r" (old), "=&r" (t), "=m" (*p)
@@ -197,9 +197,9 @@
 
 	__asm__ __volatile__(SMP_WMB "\n\
 1:	lwarx	%0,0,%4 \n\
-	xor	%1,%0,%3 \n"
-	PPC405_ERR77(0,%4)
-"	stwcx.	%1,0,%4 \n\
+	xor	%1,%0,%3 \n\
+	dcbt 	0,%4 \n\
+	stwcx.	%1,0,%4 \n\
 	bne	1b"
 	SMP_MB
 	: "=&r" (old), "=&r" (t), "=m" (*p)
--- linux-2.4.19/include/asm-ppc/bitops.h.org	Fri Sep 13 09:18:31 2002
+++ linux-2.4.19/include/asm-ppc/bitops.h	Fri Sep 13 09:07:46 2002
@@ -289,7 +289,7 @@
  * Find the first bit set in a 140-bit bitmap.
  * The first 100 bits are unlikely to be set.
  */
-static inline int sched_find_first_bit(unsigned long *b)
+static inline int _sched_find_first_bit(unsigned long *b)
 {
 	if (unlikely(b[0]))
 		return __ffs(b[0]);
--- linux-2.4.19/kernel/sched.c.org	Fri Sep 13 10:27:12 2002
+++ linux-2.4.19/kernel/sched.c	Fri Sep 13 10:12:38 2002
@@ -520,12 +520,10 @@
 			p->sleep_avg) / (EXIT_WEIGHT + 1);
 }
 
-#if CONFIG_SMP
 asmlinkage void schedule_tail(task_t *prev)
 {
 	finish_arch_switch(this_rq(), prev);
 }
-#endif
 
 static inline task_t * context_switch(task_t *prev, task_t *next)
 {
