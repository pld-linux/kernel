
 Makefile                          |    2 +-
 arch/ppc/kernel/time.c            |   12 ++++++------
 arch/ppc/syslib/open_pic_defs.h   |    3 ---
 arch/sparc64/kernel/smp.c         |    2 +-
 drivers/char/isicom.c             |    6 +++---
 drivers/input/mouse/psmouse.h     |    2 ++
 drivers/media/dvb/bt8xx/bt878.h   |    6 +++---
 drivers/media/video/bttvp.h       |   21 ++++++++++-----------
 drivers/net/hamradio/baycom_epp.c |   16 ++++++++--------
 include/asm-m68k/setup.h          |    3 ++-
 include/asm-ppc/prom.h            |    3 ---
 include/asm-ppc/time.h            |    2 +-
 include/asm-sparc64/mostek.h      |    2 --
 include/linux/generic_serial.h    |    2 --
 include/linux/i2c.h               |   32 ++++++++++++++++----------------
 15 files changed, 53 insertions(+), 61 deletions(-)

--- a/Makefile.orig	2005-03-30 13:10:50.000000000 +0200
+++ b/Makefile	2005-03-30 13:11:15.000000000 +0200
@@ -202,7 +202,7 @@
 
 HOSTCC  	= gcc
 HOSTCXX  	= g++
-HOSTCFLAGS	= -Wall -Wstrict-prototypes -O2 -fomit-frame-pointer
+HOSTCFLAGS	= -Wall -Wstrict-prototypes -O2 -fomit-frame-pointer $(call cc-option,-Wno-pointer-sign,)
 HOSTCXXFLAGS	= -O2
 
 # 	Decide whether to build built-in, modular, or both.
--- a/arch/ppc/kernel/time.c.orig	2005-06-12 04:45:37.000000000 +0200
+++ b/arch/ppc/kernel/time.c	2005-06-12 14:35:38.000000000 +0200
@@ -89,7 +89,7 @@
 
 extern unsigned long wall_jiffies;
 
-static long time_offset;
+static long ppc_time_offset;
 
 DEFINE_SPINLOCK(rtc_lock);
 
@@ -172,7 +172,7 @@
 		     xtime.tv_sec - last_rtc_update >= 659 &&
 		     abs((xtime.tv_nsec / 1000) - (1000000-1000000/HZ)) < 500000/HZ &&
 		     jiffies - wall_jiffies == 1) {
-		  	if (ppc_md.set_rtc_time(xtime.tv_sec+1 + time_offset) == 0)
+		  	if (ppc_md.set_rtc_time(xtime.tv_sec+1 + ppc_time_offset) == 0)
 				last_rtc_update = xtime.tv_sec+1;
 			else
 				/* Try again one minute later */
@@ -289,7 +289,7 @@
 	unsigned old_stamp, stamp, elapsed;
 
         if (ppc_md.time_init != NULL)
-                time_offset = ppc_md.time_init();
+                ppc_time_offset = ppc_md.time_init();
 
 	if (__USE_RTC()) {
 		/* 601 processor: dec counts down by 128 every 128ns */
@@ -334,10 +334,10 @@
 	set_dec(tb_ticks_per_jiffy);
 
 	/* If platform provided a timezone (pmac), we correct the time */
-        if (time_offset) {
-		sys_tz.tz_minuteswest = -time_offset / 60;
+        if (ppc_time_offset) {
+		sys_tz.tz_minuteswest = -ppc_time_offset / 60;
 		sys_tz.tz_dsttime = 0;
-		xtime.tv_sec -= time_offset;
+		xtime.tv_sec -= ppc_time_offset;
         }
         set_normalized_timespec(&wall_to_monotonic,
                                 -xtime.tv_sec, -xtime.tv_nsec);
--- a/arch/ppc/syslib/open_pic_defs.h.orig	2005-04-26 12:28:54.000000000 +0200
+++ b/arch/ppc/syslib/open_pic_defs.h	2005-04-26 12:28:58.000000000 +0200
@@ -172,9 +172,6 @@
     OpenPIC_Processor Processor[OPENPIC_MAX_PROCESSORS];
 };
 
-extern volatile struct OpenPIC __iomem *OpenPIC;
-
-
     /*
      *  Current Task Priority Register
      */
--- a/arch/sparc64/kernel/smp.c.orig	2005-05-12 00:41:08.000000000 +0200
+++ b/arch/sparc64/kernel/smp.c	2005-05-16 01:52:11.000000000 +0200
@@ -41,7 +41,7 @@
 extern void calibrate_delay(void);
 
 /* Please don't make this stuff initdata!!!  --DaveM */
-static unsigned char boot_cpu_id;
+unsigned char boot_cpu_id;
 
 cpumask_t cpu_online_map = CPU_MASK_NONE;
 cpumask_t phys_cpu_present_map = CPU_MASK_NONE;
--- a/include/asm-m68k/setup.h.orig	2005-04-07 20:57:45.000000000 +0200
+++ b/include/asm-m68k/setup.h	2005-04-26 12:16:54.000000000 +0200
@@ -362,12 +362,13 @@
 #ifndef __ASSEMBLY__
 extern int m68k_num_memory;		/* # of memory blocks found (and used) */
 extern int m68k_realnum_memory;		/* real # of memory blocks found */
-extern struct mem_info m68k_memory[NUM_MEMINFO];/* memory description */
 
 struct mem_info {
 	unsigned long addr;		/* physical address of memory chunk */
 	unsigned long size;		/* length of memory chunk (in bytes) */
 };
+
+extern struct mem_info m68k_memory[NUM_MEMINFO];/* memory description */
 #endif
 
 #endif /* __KERNEL__ */
--- a/include/asm-ppc/prom.h.orig	2005-04-07 20:57:54.000000000 +0200
+++ b/include/asm-ppc/prom.h	2005-04-26 12:26:25.000000000 +0200
@@ -13,9 +13,6 @@
 typedef void *phandle;
 typedef void *ihandle;
 
-extern char *prom_display_paths[];
-extern unsigned int prom_num_displays;
-
 struct address_range {
 	unsigned int space;
 	unsigned int address;
--- a/include/asm-ppc/time.h.orig	2005-04-07 20:57:09.000000000 +0200
+++ b/include/asm-ppc/time.h	2005-04-26 12:19:19.000000000 +0200
@@ -58,7 +58,7 @@
 /* Accessor functions for the timebase (RTC on 601) registers. */
 /* If one day CONFIG_POWER is added just define __USE_RTC as 1 */
 #ifdef CONFIG_6xx
-extern __inline__ int const __USE_RTC(void) {
+static __inline__ int __USE_RTC(void) {
 	return (mfspr(SPRN_PVR)>>16) == 1;
 }
 #else
--- a/include/asm-sparc64/mostek.h.orig	2005-05-12 00:42:16.000000000 +0200
+++ b/include/asm-sparc64/mostek.h	2005-05-16 01:21:46.000000000 +0200
@@ -134,13 +134,11 @@
  */
 #define MOSTEK_48T08_OFFSET	0x0000UL	/* Lower NVRAM portions */
 #define MOSTEK_48T08_48T02	0x1800UL	/* Offset to 48T02 chip */
-extern unsigned long mstk48t08_regs;
 
 /* SUN5 systems usually have 48t59 model clock chipsets.  But we keep the older
  * clock chip definitions around just in case.
  */
 #define MOSTEK_48T59_OFFSET	0x0000UL	/* Lower NVRAM portions */
 #define MOSTEK_48T59_48T02	0x1800UL	/* Offset to 48T02 chip */
-extern unsigned long mstk48t59_regs;
 
 #endif /* !(_SPARC64_MOSTEK_H) */
--- a/include/linux/generic_serial.h.orig	2005-03-16 01:09:11.000000000 +0100
+++ b/include/linux/generic_serial.h	2005-03-16 10:21:23.000000000 +0100
@@ -91,6 +91,4 @@
 int  gs_getserial(struct gs_port *port, struct serial_struct __user *sp);
 void gs_got_break(struct gs_port *port);
 
-extern int gs_debug;
-
 #endif
--- a/include/linux/i2c.h.orig	2004-12-24 22:34:01.000000000 +0100
+++ b/include/linux/i2c.h	2005-02-14 23:35:45.455135464 +0100
@@ -36,7 +36,22 @@
 
 /* --- General options ------------------------------------------------	*/
 
-struct i2c_msg;
+/*
+ * I2C Message - used for pure i2c transaction, also from /dev interface
+ */
+struct i2c_msg {
+	__u16 addr;	/* slave address			*/
+ 	__u16 flags;		
+#define I2C_M_TEN	0x10	/* we have a ten bit chip address	*/
+#define I2C_M_RD	0x01
+#define I2C_M_NOSTART	0x4000
+#define I2C_M_REV_DIR_ADDR	0x2000
+#define I2C_M_IGNORE_NAK	0x1000
+#define I2C_M_NO_RD_ACK		0x0800
+ 	__u16 len;		/* msg length				*/
+ 	__u8 *buf;		/* pointer to msg data			*/
+};
+
 struct i2c_algorithm;
 struct i2c_adapter;
 struct i2c_client;
@@ -379,21 +394,6 @@
 /* Return 1 if adapter supports everything we need, 0 if not. */
 extern int i2c_check_functionality (struct i2c_adapter *adap, u32 func);
 
-/*
- * I2C Message - used for pure i2c transaction, also from /dev interface
- */
-struct i2c_msg {
-	__u16 addr;	/* slave address			*/
- 	__u16 flags;		
-#define I2C_M_TEN	0x10	/* we have a ten bit chip address	*/
-#define I2C_M_RD	0x01
-#define I2C_M_NOSTART	0x4000
-#define I2C_M_REV_DIR_ADDR	0x2000
-#define I2C_M_IGNORE_NAK	0x1000
-#define I2C_M_NO_RD_ACK		0x0800
- 	__u16 len;		/* msg length				*/
- 	__u8 *buf;		/* pointer to msg data			*/
-};
 
 /* To determine what functionality is present */
 
--- a/drivers/char/isicom.c.orig	2005-03-16 01:08:59.000000000 +0100
+++ b/drivers/char/isicom.c	2005-03-16 10:15:56.000000000 +0100
@@ -151,9 +151,6 @@
 static int prev_card = 3;	/*	start servicing isi_card[0]	*/
 static struct tty_driver *isicom_normal;
 
-static struct isi_board isi_card[BOARD_COUNT];
-static struct isi_port  isi_ports[PORT_COUNT];
-
 static struct timer_list tx;
 static char re_schedule = 1;
 #ifdef ISICOM_DEBUG
@@ -210,6 +207,9 @@
 	int			xmit_cnt;
 };
 
+static struct isi_board isi_card[BOARD_COUNT];
+static struct isi_port  isi_ports[PORT_COUNT];
+
 /*
  *	Locking functions for card level locking. We need to own both
  *	the kernel lock for the card and have the card in a position that
--- a/drivers/input/mouse/psmouse.h.orig	2005-03-13 07:44:40.000000000 +0100
+++ b/drivers/input/mouse/psmouse.h	2005-03-13 14:08:06.000000000 +0100
@@ -1,6 +1,8 @@
 #ifndef _PSMOUSE_H
 #define _PSMOUSE_H
 
+#include <linux/libps2.h>
+
 #define PSMOUSE_CMD_SETSCALE11	0x00e6
 #define PSMOUSE_CMD_SETSCALE21	0x00e7
 #define PSMOUSE_CMD_SETRES	0x10e8
--- a/drivers/media/dvb/bt8xx/bt878.h.orig	2004-12-24 22:35:50.000000000 +0100
+++ b/drivers/media/dvb/bt8xx/bt878.h	2005-02-14 23:46:30.575062328 +0100
@@ -88,9 +88,6 @@
 
 #define BT878_RISC_SYNC_MASK	(1 << 15)
 
-extern int bt878_num;
-extern struct bt878 bt878[BT878_MAX];
-
 struct bt878 {
 	struct semaphore  gpio_lock;
 	unsigned int nr;
@@ -124,6 +121,9 @@
 	int shutdown;	
 };
 
+extern int bt878_num;
+extern struct bt878 bt878[BT878_MAX];
+
 void bt878_start(struct bt878 *bt, u32 controlreg, u32 op_sync_orin,
 		u32 irq_err_ignore);
 void bt878_stop(struct bt878 *bt);	     
--- a/drivers/media/video/bttvp.h.orig	2004-12-24 22:35:50.000000000 +0100
+++ b/drivers/media/video/bttvp.h	2005-02-14 23:52:36.512431392 +0100
@@ -250,17 +250,6 @@
 #define dprintk  if (bttv_debug >= 1) printk
 #define d2printk if (bttv_debug >= 2) printk
 
-/* our devices */
-#define BTTV_MAX 16
-extern unsigned int bttv_num;
-extern struct bttv bttvs[BTTV_MAX];
-
-#define BTTV_MAX_FBUF   0x208000
-#define VBIBUF_SIZE     (2048*VBI_MAXLINES*2)
-#define BTTV_TIMEOUT    (HZ/2) /* 0.5 seconds */
-#define BTTV_FREE_IDLE  (HZ)   /* one second */
-
-
 struct bttv_pll_info {
 	unsigned int pll_ifreq;    /* PLL input frequency        */
 	unsigned int pll_ofreq;    /* PLL output frequency       */
@@ -401,6 +390,16 @@
 	struct bttv_fh init;
 };
 
+/* our devices */
+#define BTTV_MAX 16
+extern unsigned int bttv_num;
+extern struct bttv bttvs[BTTV_MAX];
+
+#define BTTV_MAX_FBUF   0x208000
+#define VBIBUF_SIZE     (2048*VBI_MAXLINES*2)
+#define BTTV_TIMEOUT    (HZ/2) /* 0.5 seconds */
+#define BTTV_FREE_IDLE  (HZ)   /* one second */
+
 /* private ioctls */
 #define BTTV_VERSION            _IOR('v' , BASE_VIDIOCPRIVATE+6, int)
 #define BTTV_VBISIZE            _IOR('v' , BASE_VIDIOCPRIVATE+8, int)
--- a/drivers/net/hamradio/baycom_epp.c.orig	2005-03-26 04:28:38.000000000 +0100
+++ b/drivers/net/hamradio/baycom_epp.c	2005-04-03 21:34:42.000000000 +0200
@@ -398,14 +398,14 @@
  */
 
 #define ENCODEITERA(j)                         \
-({                                             \
+{                                              \
         if (!(notbitstream & (0x1f0 << j)))    \
                 goto stuff##j;                 \
   encodeend##j:    	;                      \
-})
+}
 
 #define ENCODEITERB(j)                                          \
-({                                                              \
+{                                                               \
   stuff##j:                                                     \
         bitstream &= ~(0x100 << j);                             \
         bitbuf = (bitbuf & (((2 << j) << numbit) - 1)) |        \
@@ -413,7 +413,7 @@
         numbit++;                                               \
         notbitstream = ~bitstream;                              \
         goto encodeend##j;                                      \
-})
+}
 
 
 static void encode_hdlc(struct baycom_state *bc)
@@ -631,16 +631,16 @@
 }
 
 #define DECODEITERA(j)                                                        \
-({                                                                            \
+{                                                                             \
         if (!(notbitstream & (0x0fc << j)))              /* flag or abort */  \
                 goto flgabrt##j;                                              \
         if ((bitstream & (0x1f8 << j)) == (0xf8 << j))   /* stuffed bit */    \
                 goto stuff##j;                                                \
   enditer##j:      ;                                                           \
-})
+}
 
 #define DECODEITERB(j)                                                                 \
-({                                                                                     \
+{                                                                                      \
   flgabrt##j:                                                                          \
         if (!(notbitstream & (0x1fc << j))) {              /* abort received */        \
                 state = 0;                                                             \
@@ -659,7 +659,7 @@
         numbits--;                                                                     \
         bitbuf = (bitbuf & ((~0xff) << j)) | ((bitbuf & ~((~0xff) << j)) << 1);        \
         goto enditer##j;                                                               \
-})
+}
         
 static int receive(struct net_device *dev, int cnt)
 {
