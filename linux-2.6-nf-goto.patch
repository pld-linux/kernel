 include/linux/netfilter_ipv4/ip_tables.h |    3 ++-
 net/ipv4/netfilter/ip_tables.c           |    2 +-
 2 files changed, 3 insertions(+), 2 deletions(-)

diff -Nur --exclude '*.orig' linux-2.6.13.1.org/include/linux/netfilter_ipv4/ip_tables.h linux-2.6.13.1/include/linux/netfilter_ipv4/ip_tables.h
--- linux-2.6.13.1.org/include/linux/netfilter_ipv4/ip_tables.h	2005-09-10 04:42:58.000000000 +0200
+++ linux-2.6.13.1/include/linux/netfilter_ipv4/ip_tables.h	2005-09-15 09:36:53.000000000 +0200
@@ -109,7 +109,8 @@
 
 /* Values for "flag" field in struct ipt_ip (general ip structure). */
 #define IPT_F_FRAG		0x01	/* Set if rule is a fragment rule */
-#define IPT_F_MASK		0x01	/* All possible flag bits mask. */
+#define IPT_F_GOTO		0x02	/* Set if jump is a goto */
+#define IPT_F_MASK		0x03	/* All possible flag bits mask. */
 
 /* Values for "inv" field in struct ipt_ip. */
 #define IPT_INV_VIA_IN		0x01	/* Invert the sense of IN IFACE. */
diff -Nur --exclude '*.orig' linux-2.6.13.1.org/net/ipv4/netfilter/ip_tables.c linux-2.6.13.1/net/ipv4/netfilter/ip_tables.c
--- linux-2.6.13.1.org/net/ipv4/netfilter/ip_tables.c	2005-09-10 04:42:58.000000000 +0200
+++ linux-2.6.13.1/net/ipv4/netfilter/ip_tables.c	2005-09-15 09:36:53.000000000 +0200
@@ -342,7 +342,7 @@
 					continue;
 				}
 				if (table_base + v
-				    != (void *)e + e->next_offset) {
+				    != (void *)e + e->next_offset && !(e->ip.flags & IPT_F_GOTO)) {
 					/* Save old back ptr in next entry */
 					struct ipt_entry *next
 						= (void *)e + e->next_offset;
