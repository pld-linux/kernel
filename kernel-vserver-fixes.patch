--- linux-3.3/fs/proc/base.c~	2012-03-19 21:44:42.000000000 +0100
+++ linux-3.3/fs/proc/base.c	2012-03-21 12:25:28.051092423 +0100
@@ -568,6 +568,8 @@
 				 struct task_struct *task,
 				 int hide_pid_min)
 {
+	if (vx_check(0, VS_WATCH_P))
+		return true;
 	if (pid->hide_pid < hide_pid_min)
 		return true;
 	if (in_group_p(pid->pid_gid))


diff -NurpP --minimal linux-4.9.207-vs2.3.9.11/net/core/sock.c linux-4.9.207-vs2.3.9.12/net/core/sock.c
--- linux-4.9.207-vs2.3.9.11/net/core/sock.c	2019-12-25 15:37:52.958413722 +0000
+++ linux-4.9.207-vs2.3.9.12/net/core/sock.c	2020-02-26 14:31:15.988223949 +0000
@@ -1343,9 +1343,10 @@ static struct sock *sk_prot_alloc(struct
 		if (!try_module_get(prot->owner))
 			goto out_free_sec;
 		sk_tx_queue_clear(sk);
-	}
+
 		sock_vx_init(sk);
 		sock_nx_init(sk);
+	}
 
 	return sk;
 
