--- linux-3.3/fs/proc/base.c~	2012-03-19 21:44:42.000000000 +0100
+++ linux-3.3/fs/proc/base.c	2012-03-21 12:25:28.051092423 +0100
@@ -568,6 +568,8 @@
 				 struct task_struct *task,
 				 int hide_pid_min)
 {
+	if (vx_check(0, VS_WATCH_P))
+		return true;
 	if (pid->hide_pid < hide_pid_min)
 		return true;
 	if (in_group_p(pid->pid_gid))
--- linux-3.13.10/fs/namei.c	2014-04-17 01:12:32.000000000 +0000
+++ linux-3.13.10-vs2.3.6.11/fs/namei.c	2014-04-17 01:17:10.000000000 +0000
@@ -1238,8 +1335,7 @@ static void follow_dotdot(struct nameida
 
 		if (nd->path.dentry == nd->root.dentry &&
 		    nd->path.mnt == nd->root.mnt) {
-			/* for sane '/' avoid follow_mount() */
-			return;
+			break;
 		}
 		if (nd->path.dentry != nd->path.mnt->mnt_root) {
 			/* rare case of legitimate dget_parent()... */
