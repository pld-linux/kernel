diff -urN linux/fs/proc/base.c linux.fixed/fs/proc/base.c
--- linux/fs/proc/base.c	Mon Nov 26 18:23:38 2001
+++ linux.fixed/fs/proc/base.c	Mon Nov 26 18:20:19 2001
@@ -704,13 +704,15 @@
 	get_task_struct(task);
 	inode->u.proc_i.task = task;
 	inode->i_uid = 0;
+#ifndef CONFIG_GRKERNSEC_PROC_USERGROUP
 	inode->i_gid = 0;
+#else
+	inode->i_gid = CONFIG_GRKERNSEC_PROC_GID;
+#endif
 	if (ino == PROC_PID_INO || task_dumpable(task)) {
 		inode->i_uid = task->euid;
 #ifndef CONFIG_GRKERNSEC_PROC_USERGROUP
 		inode->i_gid = task->egid;
-#else
-               inode->i_gid = CONFIG_GRKERNSEC_PROC_GID;
 #endif
 	}
 
diff -urN linux/kernel/sysctl.c linux.fixed/kernel/sysctl.c
--- linux/kernel/sysctl.c	Sat Dec  1 14:49:38 2001
+++ linux.fixed/kernel/sysctl.c	Sun Dec  2 00:19:33 2001
@@ -1060,7 +1060,9 @@
 	
 	i = (int *) table->data;
 #ifdef CONFIG_GRKERNSEC_SYSCTL
-		if(grsec_lock && write) { 
+		if (grsec_lock && write && table->de->parent->name &&
+				(strlen(table->de->parent->name) == 10) &&
+				!strcmp(table->de->parent->name,"grsecurity")) {
                         security_alert("attempt to modify grsecurity "
                         "sysctl value: %.32s by " DEFAULTSECMSG,
                         "attempted sysctl changes", table->de->name,
