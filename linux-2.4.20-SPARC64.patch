diff -ur linux-2.4.20/arch/sparc64/kernel/sparc64_ksyms.c linux-2.4.20.xxx/arch/sparc64/kernel/sparc64_ksyms.c
--- linux-2.4.20/arch/sparc64/kernel/sparc64_ksyms.c	Fri Nov 29 00:53:12 2002
+++ linux-2.4.20.xxx/arch/sparc64/kernel/sparc64_ksyms.c	Mon Dec  9 19:34:01 2002
@@ -310,12 +310,12 @@
 EXPORT_SYMBOL(sunos_sys_table);
 EXPORT_SYMBOL(sys_call_table32);
 EXPORT_SYMBOL(tl0_solaris);
-EXPORT_SYMBOL(sys_sigsuspend);
-EXPORT_SYMBOL(sys_getppid);
+//EXPORT_SYMBOL(sys_sigsuspend);
+//EXPORT_SYMBOL(sys_getppid);
 EXPORT_SYMBOL(svr4_getcontext);
 EXPORT_SYMBOL(svr4_setcontext);
 EXPORT_SYMBOL(prom_cpu_nodes);
-EXPORT_SYMBOL(sys_ioctl);
+//EXPORT_SYMBOL(sys_ioctl);
 EXPORT_SYMBOL(sys32_ioctl);
 EXPORT_SYMBOL(sparc32_open);
 #endif
--- linux-2.4.20/include/asm-sparc64/smp.h.org	Wed May 28 08:30:56 2003
+++ linux-2.4.20/include/asm-sparc64/smp.h	Wed May 28 08:31:04 2003
@@ -103,7 +103,7 @@
 	}
 }
 
-#define smp_processor_id() (current->processor)
+#define smp_processor_id() hard_smp_processor_id()
 
 /* This needn't do anything as we do not sleep the cpu
  * inside of the idler task, so an interrupt is not needed
